-- test store 

--format 
--	System_SP_Select       [SPCode], [TableName], [ColumnName], [ColumnAlias], [ColumnQuery]
--  System_sp_tablelinks   [SPCode], [TableName], [TableAlias], [Order], [JointTable], [JointTableColumn], [LinkedTableColumn], [JointType], [ExtraConditions], [CustomQuery], [IsRequired]

EXEC KAIZEN_STORE 
@ClauseSelect = N'ao.DistributionChannelID,cn.NameEntityName as NameDistributionChannel,ao.ID,ao.IsEmergency,ao.WorkDate,ao.DistributionChannelID,cn.NameEntityName as NameDistributionChannel,ao.AnalyseHour,ao.RegisterHours,ao.ApproveHours,ao.ConfirmHours,ao.Status,ao.MethodPayment,ao.ReasonOT,ao.OvertimeTypeID,ao.ShiftID,ao.InTime,ao.OutTime,ao.UserApproveID,ao.UserApproveID2,ao.UserApproveID3,ao.UserApproveID4,ao.IsConvertData,cs.ShiftName,hp.ProfileName,ao.ProfileID,hp.CodeEmp,hp.DateHire,ao.TaxType,co.OvertimeTypeName,co.Code as OvertimeTypeCode,hp1.ProfileName AS UserApproveName1,hp2.ProfileName AS UserApproveName2,hp3.ProfileName AS UserApproveName3,hp5.ProfileName AS UserApproveName4,corg.Code as OrgStructureCode,ao.UserUpdate,ao.Status as StatusTranslate,su4.UserInfoName AS UserReject,su6.UserLogin AS UserCreate,ao.DateRequest,ao.DateApprove,ao.DateReject,ao.DeclineReason,ao.ConfirmReason,ao.SendEmailStatus,ao.UserCreate,ao.DateCreate,ao.PositionID,ao.JobTitleID,ao.UserUpdate,ao.DateUpdate,ao.WorkDateRoot,cou.E_COMPANY,cou.E_BRANCH,cou.E_UNIT,cou.E_DIVISION,cou.E_DEPARTMENT,cou.E_TEAM,cou.E_SECTION,cou.E_COMPANY_CODE,cou.E_BRANCH_CODE,cou.E_UNIT_CODE,cou.E_DIVISION_CODE,cou.E_DEPARTMENT_CODE,cou.E_TEAM_CODE,cou.E_SECTION_CODE,cus.UnitName,hp.DateApplyAttendanceCode,hp4.ProfileName AS UserSubmitName,ao.MenuID,ao.Menu2ID,ao.FoodID,ao.Food2ID,ao.OvertimePlaceID,ao.Note,cw1.WorkPlaceName as OvertimePlaceName,cm.MenuName,cm1.MenuName as MenuName2,cf.FoodName,cf1.FoodName as FoodName2,hp.CodeEmpClient,cosorg.OrgStructureName AS OrgStructureNameCost,ao.FormCode,ao.FormName,corg.OrgStructureName,ao.IsMealRegistration,cp.PositionName,cwp.WorkPlaceName,cj.JobTitleName,ao.IsCarRegistration,ao.DurationType,ao.IsPayback,ao.PaybackDurationID,ao.WorkPlaceID,ao.PayrollGroupID,ao.ApproveComment,ao.ApproveComment1,ao.ApproveComment2,ao.ApproveComment3,ao.ApproveComment4,ao.WorkDateConfirm,ao.OrgStructureID,tt.EnumTranslate AS StatusView,drtt.EnumTranslate AS DurationTypeView,mtpm.EnumTranslate AS MethodPaymentView,tax.EnumTranslate AS TaxTypeView,awd.FirstInTime AS InTimeDateView,awd.LastOutTime AS OutTimeDateView,ccc.Code AS CodeCostCentre,cet.EmployeeTypeName,tgrs.GradeAttendanceName,cjt.Code AS CodeJobType,cjt.JobTypeName,ao.IsOvertimeBreak,ao.AdditionalHours,ao.IsNotCheckInOut,ao.TakenCompLeaveHours,ao.Notes,cc.CompanyName,ao.TimeLogStartOT,ao.TimeLogEndOT,ao.TimeLogStartShift,ao.TimeLogEndShift,ao.IsFreeOfCharge,ao.AdditionalHours,rqt.EnumTranslate AS CancelationStatus,ao.IsExplanatory,ao.IsNotCheckInOut,csg.ShopGroupName AS BusinessUnitTypeView,cshop.ShopName AS BusinessUnitView,ao.BreakRegisterHours,ao.BreakConfirmHours,wpt.WorkPlaceName AS WorkPlaceTransName,hp9.ProfileName AS UserProcessApproveName,hp10.ProfileName AS UserProcessApprove2Name,hp11.ProfileName AS UserProcessApprove3Name,hp12.ProfileName AS UserProcessApprove4Name,csg.Code AS BusinessUnitTypeCodeView,cshop.Code AS BusinessUnitCodeView,ao.FileAttach,cpt.CompanyName AS CompanyTransName,ao.OvertimePlanID,cor.OvertimeReasonName AS ReasonNameOT2,ao.Type,rot.EnumTranslate AS TypeView,escm.EnumTranslate AS StatusComment,essm.EnumTranslate AS CommentSendMailStatus,cord.OvertimeReasonDetailName,ao.ReasonOT2ID,ao.OvertimeReasonDetailID,ao.UserComment1,ao.UserComment2,ao.UserComment3,ao.UserComment4,aop.DayType AS DayTypeOTP,drtt2.EnumTranslate AS DurationTypeOTPView,aop.TimeFrom AS TimeFromOTP,aop.TimeTo AS TimeToOTP,aop.RegisterHours  AS RegisterHoursOTP,aop.OvertimeHour AS OvertimeHourOTP,mtpm2.EnumTranslate AS MethodPaymentOTP,aophp1.ProfileName AS UserApproveNameOTP1,aophp3.ProfileName AS UserApproveNameOTP2,aophp4.ProfileName AS UserApproveNameOTP3,aophp2.ProfileName AS UserApproveNameOTP4,aop.ReasonOT AS ReasonOTP',
@ClauseFrom = N'*Att_Overtime ao*INNER JOIN $Select ID From Hre_Profile Where IsDelete is null$ hp ON ao.ProfileID = hp.ID*LEFT JOIN Cat_Shift cs ON ao.ShiftID = cs.ID AND cs.IsDelete IS NULL*LEFT JOIN Cat_OvertimeType co ON ao.OvertimeTypeID = co.ID AND co.IsDelete IS NULL*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ su1 ON ao.UserApproveID = su1.ID AND su1.IsDelete IS NULL*LEFT JOIN $Select ID From Hre_Profile Where IsDelete is null$ hp1 ON hp1.id = su1.ProfileID AND hp1.IsDelete IS NULL*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ su2 ON ao.UserApproveID2 = su2.ID AND su2.IsDelete IS NULL*LEFT JOIN $Select ID From Hre_Profile Where IsDelete is null$ hp2 ON hp2.id = su2.ProfileID AND hp2.IsDelete IS NULL*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ su5 ON ao.UserApproveID4 = su5.ID AND su5.IsDelete IS NULL*LEFT JOIN $Select ID From Hre_Profile Where IsDelete is null$ hp5 ON hp5.id = su5.ProfileID AND hp5.IsDelete IS NULL*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ su3 ON ao.UserApproveID3 = su3.ID AND su3.IsDelete IS NULL*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ su4 ON ao.UserRejectID = su4.Id AND su4.IsDelete IS NULL*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ su6 ON ao.UserCreate = su6.UserLogin AND su6.IsDelete IS NULL*LEFT JOIN $Select ID From Hre_Profile Where IsDelete is null$ hp3 ON hp3.id = su3.ProfileID AND hp3.IsDelete IS NULL*LEFT JOIN $Select ID From Cat_OrgStructure Where IsDelete is null$ corg ON ao.OrgStructureID = corg.ID AND corg.IsDelete IS NULL*LEFT JOIN Cat_OrgUnit cou ON ao.OrgStructureID = cou.OrgStructureID AND cou.IsDelete IS NULL*LEFT JOIN $Select ID From Cat_WorkPlace Where IsDelete is null$ cwp ON ao.WorkPlaceID = cwp.ID AND cwp.IsDelete IS NULL*LEFT JOIN Cat_Position cp ON ao.PositionID = cp.id AND cp.IsDelete IS NULL*LEFT JOIN $Select ID From Hre_Profile Where IsDelete is null$ hp4 ON hp4.ID = ao.UserSubmit AND hp4.IsDelete IS NULL*LEFT JOIN Can_Menu cm ON cm.ID = ao.MenuID and cm.IsDelete IS NULL*LEFT JOIN Can_Menu cm1 ON cm1.ID = ao.MenuID and cm1.IsDelete IS NULL*LEFT JOIN Can_Food cf ON cf.ID = ao.FoodID and cf.IsDelete IS NULL*LEFT JOIN Can_Food cf1 ON cf1.ID = ao.FoodID and cf1.IsDelete IS NULL*LEFT JOIN $Select ID From Cat_WorkPlace Where IsDelete is null$ cw1 ON cw1.ID = ao.OvertimePlaceID and cw1.IsDelete IS NULL*LEFT JOIN $Select ID From Cat_OrgStructure Where IsDelete is null$ cosorg ON ao.OrgStructureCostID = cosorg.ID AND corg.IsDelete IS NULL*LEFT JOIN Cat_JobTitle cj ON cj.ID = ao.JobTitleID AND cj.IsDelete IS NULL*LEFT JOIN Cat_UnitStructure cus ON ao.UnitStructureId = cus.ID and cus.IsDelete IS NULL*LEFT JOIN $SELECT ID, CostCentreName, Code, IsDelete FROM Cat_CostCentre$ ccc ON ao.CostCentreID = ccc.ID AND ccc.IsDelete IS NULL*LEFT JOIN $SELECT ID, EmployeeTypeName, IsDelete FROM Cat_EmployeeType$ cet ON ao.EmployeeTypeID = cet.ID and cet.IsDelete IS NULL*LEFT JOIN $SELECT ID, Code, JobTypeName, IsDelete FROM Cat_JobType$ cjt ON ao.JobTypeID = cjt.ID and cjt.IsDelete IS NULL*LEFT JOIN #tblEnumStatusView tt ON tt.EnumKey = ao.Status*LEFT JOIN $Select ID From #tblEnumDurationTypeView Where IsDelete is null$ drtt ON drtt.EnumKey = ao.DurationType*LEFT JOIN $Select ID From #tblEnumMethodPaymentView Where IsDelete is null$ mtpm ON mtpm.EnumKey = ao.MethodPayment*LEFT JOIN #tblTaxType tax ON tax.EnumKey = ao.TaxType*left join $Select ID From Cat_Company Where IsDelete is null$ cc on ao.CompanyID= cc.ID and cc.IsDelete is null*LEFT JOIN #tblEnumStatusCancelView rqt ON rqt.EnumKey = rqc.Status*LEFT JOIN $SELECT ID, ShopGroupName,Code, IsDelete FROM Cat_ShopGroup$ csg ON csg.ID = ao.BusinessUnitTypeID AND csg.IsDelete IS NULL*LEFT JOIN $SELECT ID, ShopName,Code, IsDelete FROM Cat_Shop$ cshop ON cshop.ID = ao.BusinessUnitID AND cshop.IsDelete IS NULL*LEFT JOIN $Select ID From Cat_WorkPlace Where IsDelete is null$ wpt ON ao.WorkPlaceTransID = wpt.ID AND wpt.IsDelete IS NULL*LEFT JOIN $Select ID From Cat_Company Where IsDelete is null$ cpt ON ao.CompanyTransID = cpt.ID AND cpt.IsDelete IS NULL*LEFT JOIN $SELECT ID, ProfileID FROM Sys_UserInfo WHERE IsDelete IS NULL $ su7 ON su7.ID=ao.UserProcessApproveID*LEFT JOIN $SELECT ID, ProfileName FROM Hre_Profile WHERE IsDelete IS NULL $ hp9 ON hp9.ID=su7.ProfileID*LEFT JOIN $SELECT ID, ProfileID FROM Sys_UserInfo WHERE IsDelete IS NULL $ su8 ON su8.ID=ao.UserProcessApproveID2*LEFT JOIN $SELECT ID, ProfileName FROM Hre_Profile WHERE IsDelete IS NULL $ hp10 ON hp10.ID=su8.ProfileID*LEFT JOIN $SELECT ID, ProfileID FROM Sys_UserInfo WHERE IsDelete IS NULL $ su9 ON su9.ID=ao.UserProcessApproveID3*LEFT JOIN $SELECT ID, ProfileName FROM Hre_Profile WHERE IsDelete IS NULL $ hp11 ON hp11.ID=su9.ProfileID*LEFT JOIN $SELECT ID, ProfileID FROM Sys_UserInfo WHERE IsDelete IS NULL $ su10 ON su10.ID=ao.UserProcessApproveID4*LEFT JOIN $SELECT ID, ProfileName FROM Hre_Profile WHERE IsDelete IS NULL $ hp12 ON hp12.ID=su10.ProfileID*LEFT JOIN Cat_OvertimeReason cor ON cor.ID = ao.ReasonOT2ID AND cor.IsDelete IS NULL*LEFT JOIN Cat_NameEntity cn ON cn.ID = ao.DistributionChannelID AND cn.IsDelete IS NULL*LEFT JOIN #tblRegisOvertimeType rot ON rot.EnumKey = ao.Type*LEFT JOIN #tblEnumStatusComment escm ON escm.EnumKey = ao.StatusComment*LEFT JOIN #tblEnumStatusSendMailComment essm ON essm.EnumKey = ao.CommentSendMailStatus*LEFT JOIN Cat_OvertimeReasonDetail cord ON cord.ID = ao.OvertimeReasonDetailID AND cord.IsDelete IS NULL*LEFT JOIN $Select ID From #tblEnumDurationTypeView Where IsDelete is null$ drtt2 ON drtt2.EnumKey = aop.DurationType*LEFT JOIN $Select ID From #tblEnumMethodPaymentView Where IsDelete is null$ mtpm2 ON mtpm2.EnumKey = aop.MethodPayment*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ aopsu1 ON aop.UserApproveID = aopsu1.ID AND aopsu1.IsDelete IS NULL*LEFT JOIN $Select ID From Hre_Profile Where IsDelete is null$ aophp1 ON aophp1.id = aopsu1.ProfileID AND aophp1.IsDelete IS NULL*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ aopsu2 ON aop.UserApproveID2 = aopsu2.ID AND aopsu2.IsDelete IS NULL*LEFT JOIN $Select ID From Hre_Profile Where IsDelete is null$ aophp2 ON aophp2.id = aopsu2.ProfileID AND aophp2.IsDelete IS NULL*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ aopsu3 ON aop.UserApproveID3 = aopsu3.ID AND aopsu3.IsDelete IS NULL*LEFT JOIN $Select ID From Hre_Profile Where IsDelete is null$ aophp3 ON aophp3.id = aopsu3.ProfileID AND aophp3.IsDelete IS NULL*LEFT JOIN $Select ID From Sys_UserInfo Where IsDelete is null$ aopsu4 ON aop.UserApproveID4 = aopsu4.ID AND aopsu4.IsDelete IS NULL*LEFT JOIN $Select ID From Hre_Profile Where IsDelete is null$ aophp4 ON aophp4.id = aopsu4.ProfileID AND aophp4.IsDelete IS NULL*INNER JOIN #tblPermission fcP ON fcP.Id = ao.ProfileID*LEFT JOIN $Select ID From Att_OvertimePlan$ aop ON aop.ProfileID = ao.ProfileID*LEFT JOIN $SELECT ID, Status, RecordID FROM Att_RequestCancel WHERE IsDelete IS NULL$ rqc ON rqc.RecordID = ao.ID*LEFT JOIN $SELECT ID, WorkDate, ProfileID, FirstInTime, LastOutTime, IsDelete FROM Att_WorkDay$ awd ON ao.ProfileID = awd.ProfileID AND awd.IsDelete IS NULL*INNER JOIN #tblTempGradeResult tgrs ON ao.ProfileID = tgrs.ProfileID',
@SpCode = 'SP_GET_OT_MAIN'		

